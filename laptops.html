<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo | Bluetech</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = { theme: { extend: { colors: { 'bt-deep': '#0A0F1D', 'bt-primary': '#2563EB', 'bt-card': '#161E31', 'bt-border': 'rgba(255, 255, 255, 0.08)' } } } }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #0A0F1D; color: #F8FAFC; text-align: left; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .product-card { transition: all 0.4s ease; text-align: left; }
        .product-card:hover { transform: translateY(-8px); border-color: #2563EB; }
    </style>
</head>
<body class="antialiased">
    <nav class="fixed w-full z-50 px-6 py-4">
        <div class="max-w-7xl mx-auto glass rounded-2xl px-6 py-3 flex justify-between items-center text-left">
            <a href="index.html" class="text-2xl font-black text-bt-primary uppercase">BlueTech</a>
            <div class="flex gap-6 text-sm font-semibold">
                <a href="index.html" class="hover:text-bt-primary transition">Inicio</a>
                <a href="laptops.html" class="text-bt-primary">Laptops</a>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 pt-40 pb-20">
        <div class="mb-12 relative max-w-2xl mx-auto lg:mx-0">
            <input type="text" id="laptop-search" placeholder="Buscar modelo, marca o procesador..." 
                   class="w-full bg-bt-card border border-bt-border rounded-2xl py-5 px-6 pl-14 focus:ring-2 focus:ring-bt-primary focus:outline-none transition-all text-sm">
            <i class="fa-solid fa-search absolute left-5 top-1/2 -translate-y-1/2 text-slate-500"></i>
        </div>

        <div id="laptop-loader" class="text-center py-20">
            <i class="fa-solid fa-circle-notch animate-spin text-bt-primary text-5xl"></i>
            <p class="mt-6 text-slate-500 font-bold uppercase tracking-widest text-xs">Sincronizando inventario...</p>
        </div>
        
        <div id="laptop-container" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-8 hidden"></div>
    </main>

    <script>
        const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycby_PNCQVB_Cjfx5Nt5HB6sUjnN-gd5JTAbws3680zY_bgE6n-5w6WCKPRDYPCO2_Qwn/exec';
        let allLaptops = [];

        async function fetchLaptops() {
            try {
                // Configuración necesaria para evitar el error 'Failed to fetch' en Vercel
                const response = await fetch(GAS_WEB_APP_URL, { 
                    method: 'GET', 
                    mode: 'cors', 
                    redirect: 'follow' 
                });
                allLaptops = await response.json();
                renderLaptops(allLaptops);
                document.getElementById('laptop-loader').classList.add('hidden');
                document.getElementById('laptop-container').classList.remove('hidden');
            } catch (error) { 
                console.error("Error:", error); 
                document.getElementById('laptop-loader').innerHTML = '<p class="text-red-500 font-bold uppercase text-xs">Error de conexión con el inventario</p>';
            }
        }

        function renderLaptops(data) {
            const container = document.getElementById('laptop-container');
            if (data.length === 0) {
                container.innerHTML = `<p class="text-slate-500 col-span-full text-center py-20 italic text-left">No se encontraron equipos.</p>`;
                return;
            }
            container.innerHTML = data.map(laptop => `
                <div class="bg-bt-card rounded-[2.5rem] p-5 border border-bt-border product-card group animate__animated animate__fadeIn text-left">
                    <div class="bg-bt-deep rounded-[2rem] h-48 mb-6 flex items-center justify-center overflow-hidden">
                        <img src="${laptop.imagen_url}" class="max-h-32 object-contain group-hover:scale-110 transition duration-700" alt="${laptop.modelo}">
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-bold text-lg leading-tight text-left">${laptop.modelo}</h3>
                            <span class="text-bt-primary font-black">$${laptop.precio}</span>
                        </div>
                        <p class="text-slate-500 text-[10px] mb-6 uppercase tracking-widest font-semibold italic text-left">${laptop.procesador} · ${laptop.ram} · ${laptop.ssd}</p>
                        <a href="https://wa.me/1809XXXXXXX?text=Hola,%20me%20interesa%20el%20modelo%20${encodeURIComponent(laptop.modelo)}" 
                           class="block w-full bg-bt-primary py-3 rounded-xl font-bold text-xs text-center hover:bg-bt-accent hover:text-bt-deep transition shadow-lg shadow-blue-900/20">Cotizar</a>
                    </div>
                </div>
            `).join('');
        }

        document.getElementById('laptop-search').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const filtered = allLaptops.filter(l => 
                l.modelo.toLowerCase().includes(searchTerm) || 
                l.marca.toLowerCase().includes(searchTerm) ||
                l.procesador.toLowerCase().includes(searchTerm)
            );
            renderLaptops(filtered);
        });

        document.addEventListener('DOMContentLoaded', fetchLaptops);
    </script>
</body>
</html>
